#include "sample_state.h"

#include "math.h"

void state_eval(int l_edge,
                /*Inputs:*/
                const real_t * restrict y,
                const real_t * restrict v,
                const real_t * restrict x,
                const real_t * restrict param,
                /*Outputs:*/
                real_t * restrict F,
                real_t * restrict K,
                real_t * restrict KV)
{
    real_t theta[1];
    {
        int i;
        for(i= 0; i<1; i++) theta[i]=0.0;
    }

    real_t theta_Dy0[2];
    {
        int i;
        for(i= 0; i<2; i++) theta_Dy0[i]=0.0;
    }

    {
        int i;
        for(i=1; i<l_edge; i++) {
            /* Evaluation of theta */
            theta[0] += -1.0*param[0]*((x[0] - x[2*i])*(y[0] - y[2*i]) + (x[1] - x[2*i + 1])*(y[1] - y[2*i + 1]))*(sqrt(pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2)) - sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)));
        }
    }

    {
        int i;
        for(i=1; i<l_edge; i++) {
            /* Evaluation of theta_Dy0 */
            theta_Dy0[0] += -1.0*param[0]*(x[0] - x[2*i])*(sqrt(pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2)) - sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2))) - 1.0*param[0]*(-y[0] + y[2*i])*((x[0] - x[2*i])*(y[0] - y[2*i]) + (x[1] - x[2*i + 1])*(y[1] - y[2*i + 1]))*(sqrt(pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2)) - sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*pow(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2), 3.0L/2.0L)) + 1.0*param[0]*(y[0] - y[2*i])*((x[0] - x[2*i])*(y[0] - y[2*i]) + (x[1] - x[2*i + 1])*(y[1] - y[2*i + 1]))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)));
            theta_Dy0[1] += -1.0*param[0]*(x[1] - x[2*i + 1])*(sqrt(pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2)) - sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2))) - 1.0*param[0]*(-y[1] + y[2*i + 1])*((x[0] - x[2*i])*(y[0] - y[2*i]) + (x[1] - x[2*i + 1])*(y[1] - y[2*i + 1]))*(sqrt(pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2)) - sqrt(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*pow(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2), 3.0L/2.0L)) + 1.0*param[0]*(y[1] - y[2*i + 1])*((x[0] - x[2*i])*(y[0] - y[2*i]) + (x[1] - x[2*i + 1])*(y[1] - y[2*i + 1]))/((pow(x[0] - x[2*i], 2) + pow(x[1] - x[2*i + 1], 2))*(pow(y[0] - y[2*i], 2) + pow(y[1] - y[2*i + 1], 2)));
        }
    }

    {
        int i;
        for(i=1; i<l_edge; i++) {
            /* Evaluation of F */
            F[0] += 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            F[1] += 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            /* Evaluation of F */
            F[2*i] -= 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            F[2*i + 1] -= 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
        }
    }

    {
        int i;
        for(i=1; i<l_edge; i++) {
            /* Evaluation of K */
            K[0] += 2.0*param[0]*pow(-y[0] + y[2*i], 2)*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(y[0] - y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*pow(-y[0] + y[2*i], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[0]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            K[1] += 2.0*param[0]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(y[1] - y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[1]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            K[2*l_edge] += 2.0*param[0]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(y[0] - y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*pow(-y[0] + y[2*i], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[0]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            K[2*l_edge + 1] += 2.0*param[0]*pow(-y[1] + y[2*i + 1], 2)*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(y[1] - y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[1]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            /* Evaluation of K */
            K[2*i] += 2.0*param[0]*(-y[0] + y[2*i])*(y[0] - y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-y[0] + y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            K[2*i + 1] += 2.0*param[0]*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-y[1] + y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            K[2*i + 2*l_edge] += 2.0*param[0]*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-y[0] + y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            K[2*i + 2*l_edge + 1] += 2.0*param[0]*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-y[1] + y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            /* Evaluation of K */
            K[4*i*l_edge] -= 2.0*param[0]*pow(-y[0] + y[2*i], 2)*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(y[0] - y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*pow(-y[0] + y[2*i], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[0]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            K[4*i*l_edge + 1] -= 2.0*param[0]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(y[1] - y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[1]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            K[2*l_edge*(2*i + 1)] -= 2.0*param[0]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(y[0] - y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*pow(-y[0] + y[2*i], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[0]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            K[2*l_edge*(2*i + 1) + 1] -= 2.0*param[0]*pow(-y[1] + y[2*i + 1], 2)*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(y[1] - y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) - (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) - (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 8.0*param[1]*theta_Dy0[1]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
            /* Evaluation of K */
            K[4*i*l_edge + 2*i] -= 2.0*param[0]*(-y[0] + y[2*i])*(y[0] - y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-y[0] + y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            K[4*i*l_edge + 2*i + 1] -= 2.0*param[0]*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[0] + y[2*i])*(3.0*pow(param[0], -4.0)*param[1]*(-y[1] + y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            K[2*i + 2*l_edge*(2*i + 1)] -= 2.0*param[0]*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-y[0] + y[2*i])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[0] + v[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[0] - y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[0] + x[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(y[0] - y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            K[2*i + 2*l_edge*(2*i + 1) + 1] -= 2.0*param[0]*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + 2.0*param[0]*(-y[1] + y[2*i + 1])*(3.0*pow(param[0], -4.0)*param[1]*(-y[1] + y[2*i + 1])/(M_PI*(1.0*param[2] + 1.0)*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L) + (-v[1] + v[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])*(y[1] - y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*pow(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2), 3.0L/2.0L)) + (-x[1] + x[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 2.0*param[0]*(3.0*pow(param[0], -4.0)*param[1]*(-sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2)) + sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)))/(M_PI*(1.0*param[2] + 1.0)) - param[3]*((-v[0] + v[2*i])*(-y[0] + y[2*i])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)) + (-v[1] + v[2*i + 1])*(-y[1] + y[2*i + 1])/sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + 4.0*param[1]*theta[0]*(-7.0*param[2] + 2.0)*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))/(pow(M_PI, 2)*pow(param[0], 6)*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0)))/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            {
                int j;
                for(j=1; j<l_edge; j++) {
                    /* Evaluation of K */
                    K[2*j] += 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[0] + x[2*j])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[0] + y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[0] - y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    K[2*j + 1] += 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[1] + x[2*j + 1])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[1] + y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[1] - y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    K[2*j + 2*l_edge] += 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[0] + x[2*j])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[0] + y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[0] - y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    K[2*j + 2*l_edge + 1] += 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[1] + x[2*j + 1])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[1] + y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[1] - y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    /* Evaluation of K */
                    K[4*i*l_edge + 2*j] -= 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[0] + x[2*j])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[0] + y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[0] - y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    K[4*i*l_edge + 2*j + 1] -= 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[0] + y[2*i])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[1] + x[2*j + 1])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[1] + y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[1] - y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    K[2*j + 2*l_edge*(2*i + 1)] -= 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[0] + x[2*j])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[0] + y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[0] - y[2*j])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                    K[2*j + 2*l_edge*(2*i + 1) + 1] -= 8.0*param[1]*(-7.0*param[2] + 2.0)*(-y[1] + y[2*i + 1])*((-x[0] + x[2*i])*(-y[0] + y[2*i])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))) + (-x[1] + x[2*i + 1])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))))*(-1.0*param[0]*(-x[1] + x[2*j + 1])*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) + 1.0*param[0]*(-y[1] + y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2))) - 1.0*param[0]*(y[1] - y[2*j + 1])*((x[0] - x[2*j])*(y[0] - y[2*j]) + (x[1] - x[2*j + 1])*(y[1] - y[2*j + 1]))*(sqrt(pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2)) - sqrt(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2)))/((pow(x[0] - x[2*j], 2) + pow(x[1] - x[2*j + 1], 2))*pow(pow(y[0] - y[2*j], 2) + pow(y[1] - y[2*j + 1], 2), 3.0L/2.0L)))/(pow(M_PI, 2)*pow(param[0], 5)*sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*sqrt(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2))*(12.0*pow(param[2], 2) + 6.0*param[2] - 6.0));
                }
            }
        }
    }

    {
        int i;
        for(i=1; i<l_edge; i++) {
            /* Evaluation of KV */
            KV[0] += 2.0*param[0]*param[3]*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[1] += 2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*l_edge] += 2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*l_edge + 1] += 2.0*param[0]*param[3]*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            /* Evaluation of KV */
            KV[2*i] += -2.0*param[0]*param[3]*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*i + 1] += -2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*i + 2*l_edge] += -2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*i + 2*l_edge + 1] += -2.0*param[0]*param[3]*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            /* Evaluation of KV */
            KV[4*i*l_edge] -= 2.0*param[0]*param[3]*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[4*i*l_edge + 1] -= 2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*l_edge*(2*i + 1)] -= 2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*l_edge*(2*i + 1) + 1] -= 2.0*param[0]*param[3]*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            /* Evaluation of KV */
            KV[4*i*l_edge + 2*i] -= -2.0*param[0]*param[3]*pow(-y[0] + y[2*i], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[4*i*l_edge + 2*i + 1] -= -2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*i + 2*l_edge*(2*i + 1)] -= -2.0*param[0]*param[3]*(-y[0] + y[2*i])*(-y[1] + y[2*i + 1])/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
            KV[2*i + 2*l_edge*(2*i + 1) + 1] -= -2.0*param[0]*param[3]*pow(-y[1] + y[2*i + 1], 2)/(sqrt(pow(-x[0] + x[2*i], 2) + pow(-x[1] + x[2*i + 1], 2))*(pow(-y[0] + y[2*i], 2) + pow(-y[1] + y[2*i + 1], 2)));
        }
    }
}

void state_eval_wr(int l_edge, const real_t * restrict in, real_t * restrict out) {
    state_eval(l_edge,in, in+2*(l_edge-0), in+2*(l_edge-0)+2*(l_edge-0), in+2*(l_edge-0)+2*(l_edge-0)+2*(l_edge-0),
               out, out+2*(l_edge-0), out+2*(l_edge-0)+(2*(l_edge-0))*(2*(l_edge-0)));
}

kernel_t kernel_state = {
    .nmap = 2,
    .maps = {
        { .dim=2, .v_start=0, .v_end=-1 },
        { .dim=4, .v_start=-1, .v_end=-1 }
    },

    .ninp = 4,
    .inp = {
        { .field_number=0, .map_num=0, .name="y" },
        { .field_number=1, .map_num=0, .name="v" },
        { .field_number=2, .map_num=0, .name="x" },
        { .field_number=3, .map_num=1, .name="param" }
    },

    .noutp = 3,
    .outp = {
        { .rank = 1, .nmap = 1, .map_nums = { 0 } },
        { .rank = 2, .nmap = 1, .map_nums = { 0 } },
        { .rank = 2, .nmap = 1, .map_nums = { 0 } }
    },
    .eval=state_eval_wr,
    .name="state"
};

